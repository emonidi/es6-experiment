{"version":3,"sources":["app/scripts/bookholder.js"],"names":[],"mappings":"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","file":"app/scripts/bookholder.js","sourcesContent":["import LazyImageLoader from '/lazyimageloader';\r\nexport default class BookHolder{\r\n\tconstructor(){\r\n\t\tthis.el = document.querySelector('#book-holder');\r\n\t\tthis.ul =  document.createElement('ul');\r\n\t\tthis.ul.setAttribute('class','list-group');\r\n\t\tthis.fragment =  document.createDocumentFragment();\r\n\t\tthis.parser  = new DOMParser();\r\n\t\tthis.loader = new LazyImageLoader();\r\n\t}\r\n\r\n\tappendList(items){\r\n\t\tthis.clearBooks();\r\n\t\tfirebase.getLikedBooks((likedBooks)=>{\r\n\t\t\tconsole.log(likedBooks);\r\n\t\t\tfor(var item of items.items){\r\n\t\t\t\r\n\t\t\t\tlet info = item.volumeInfo;\r\n\t\t\t\tif(info.industryIdentifiers && info.industryIdentifiers[0]){\r\n\t\t\t\t\tlet isbn = info.industryIdentifiers[0].identifier;\r\n\t\t\t\t\tinfo.liked = likedBooks.indexOf(isbn) > -1 ? isbn : false ;\r\n\t\t\t\t}\r\n\t\t\t\tlet htmlString = this.listItemTemplate(info);\r\n\t\t\t\t\r\n\t\t\t\tthis.fragment.appendChild(htmlString);\r\n\r\n\t\t\t}\r\n\t\t\r\n\t\t\tthis.el.appendChild(this.fragment);\r\n\t\t});\r\n\t\t\r\n\t}\r\n\r\n\tsetLikeFunctionality(elem){\r\n\t\tlet self = this;\r\n\t\tlet href = elem.querySelector('.like a');\r\n\t\tvar isbn = href.getAttribute('data-book-isbn');\r\n\t\thref.addEventListener('click',(e) => {\r\n\t\t\tlet href = document.querySelector('[data-book-isbn = \"'+isbn+'\"]');\r\n\t\t\tlet liked = href.getAttribute('data-book-liked');\r\n\t\t\tlet bookData = {\r\n\t\t\t\tisbn: href.getAttribute('data-book-isbn'),\r\n\t\t\t\ttitle: href.getAttribute('data-book-title')\r\n\t\t\t}\r\n\t\t\te.preventDefault();\r\n\t\t\tif(liked !== 'false'){\r\n\t\t\t\tfirebase.remove(bookData,(response) => {\r\n\t\t\t\t\tself.setDisliked(elem);\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tfirebase.save(bookData,(response) => {\r\n\t\t\t\t\tif(response.isbn || response.title){\r\n\t\t\t\t\t\tself.setLiked(elem,response.isbn)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t \r\n\t\t});\r\n\t}\r\n\r\n\tsetLiked(elem,liked){\r\n\t\tconsole.log(elem);\r\n\t\tvar heartIcon = elem.querySelector('.glyphicon');\r\n\t\tvar classString  = heartIcon.getAttribute('class');\r\n\t\theartIcon.setAttribute('class',classString.replace('glyphicon-heart-empty','glyphicon-heart'));\r\n\r\n\t\theartIcon.parentNode.setAttribute('data-book-liked',liked);\r\n\r\n\t}\r\n\r\n\tsetDisliked(elem){\r\n\r\n\t\tvar heartIcon = elem.querySelector('.glyphicon');\r\n\t\tvar classString  = heartIcon.getAttribute('class');\r\n\t\theartIcon.setAttribute('class',classString.replace('glyphicon-heart','glyphicon-heart-empty'));\r\n\t\t\t\theartIcon.parentNode.setAttribute('data-book-liked','false');\r\n\r\n\t}\r\n\r\n\tclearBooks(){\r\n\t\tthis.ul.innerHTML = '';\r\n\t\tthis.el.innerHTML = '';\r\n\t\tthis.fragment.innerHTML = '';\r\n\t}\r\n\r\n\tlistItemTemplate(item){\r\n\t\tlet image = '';\r\n\t\tlet div = document.createElement('div');\r\n\t\tdiv.setAttribute('class','col-md-3 col-sm-6 col-xs-12 text-center');\r\n\t\tlet title = item.title ? item.title.substr(0,30) : \"unknown\";\r\n\t\tlet bookData = {\r\n\t\t\t\tisbn: item.industryIdentifiers ? item.industryIdentifiers[0].identifier : undefined,\r\n\t\t\t\ttitle:item.title,\r\n\t\t\t\tliked:item.liked\r\n\t\t}\r\n\t\tlet likeIconClass = item.liked ? 'glyphicon-heart' : 'glyphicon-heart-empty'\r\n\t\tif(item.imageLinks && item.imageLinks.thumbnail){\r\n\t\t\t\r\n\t\t\timage = '<div class=\"thumb\">'+\r\n\t\t\t\t\t\t'<img class=\"book-image\" data-src=\"'+item.imageLinks.thumbnail.replace('zoom=1','zoom=2')+'\"  src=\"../images/book-icon.png\"/>'+\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t'<div class=\"caption\">'+\r\n\t\t\t\t\t\t\t'<span>'+title+'</span>'+\r\n\t\t\t\t\t\t\t'<span class=\"text-right like\">'+\r\n\t\t\t\t\t\t\t\t'<a href=\"#\" data-book-isbn=\"'+bookData.isbn+'\" data-book-title=\"'+bookData.title+'\" data-book-liked=\"'+bookData.liked+'\">'+\r\n\t\t\t\t\t\t\t\t\t'<i class=\"glyphicon '+likeIconClass+'\"></i>'+\r\n\t\t\t\t\t\t\t\t'</a>'+\r\n\t\t\t\t\t\t\t'</span>'+\r\n\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t'</div>';\r\n\t\t}else{\r\n\t\t\timage = '<div class=\"thumb\">'+\r\n\t\t\t\t\t\t'<img class=\"book-image\" src=\"../images/book-icon.png\" class=\"book-icon\"/>'+\r\n\t\t\t\t\t\t'<div class=\"caption\">'+\r\n\t\t\t\t\t\t\t'<span>'+title+'</span>'+\r\n\t\t\t\t\t\t\t'<span class=\"text-right like\">'+\r\n\t\t\t\t\t\t\t\t'<a href=\"#\" data-book-isbn=\"'+bookData.isbn+'\" data-book-title=\"'+bookData.title+'\" data-book-liked=\"'+bookData.liked+'\">'+\r\n\t\t\t\t\t\t\t\t\t'<i class=\"glyphicon '+likeIconClass+'\"></i>'+\r\n\t\t\t\t\t\t\t\t'</a>'+\r\n\t\t\t\t\t\t\t'</span>'+\r\n\t\t\t\t\t\t'</div>'+\r\n\t\t\t\t\t '</div>';\r\n\r\n\t\t}\r\n\t\t\r\n\r\n\r\n\t\tdiv.innerHTML = image\r\n\t\tthis.loader.loadImages(div);\r\n\t\tthis.setLikeFunctionality(div);\r\n\t\treturn div;\r\n\t}\r\n}"]}